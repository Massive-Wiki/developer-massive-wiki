{% set page_title = title ~ ' - ' ~ wiki_title if title != 'README' else wiki_title %}{% include '_header.html' %}
<body>
  <div id="header">
    <span id="hamburger-btn" class="hidden">&#9776;</span> {{page_title}}
  </div>

  <div class="container" id="flex-container">
    <div id="side-column">
      <div>
        <button id="hide-btn">Hide</button>
        <button id="move-btn" class="hidden">Move to Sidebar</button>
      </div>
      {{ sidebar_body }}
    </div>

    <div id="main-column">
      {{ markdown_body }}
    </div>
  </div>

<!-- TODO FOR DOLCE: move to separate JS file -->
  <script type="text/javascript">
    let isSideColumnVisibleByUser = true;

      function alignSideColumn() {
          const mainColumn = document.getElementById('main-column');
          const sideColumn = document.getElementById('side-column');
          const mainColumnTop = mainColumn.getBoundingClientRect().top + window.scrollY;
          sideColumn.style.top = mainColumnTop + 'px';
      }

      document.getElementById('hide-btn').addEventListener('click', function() {
          this.classList.add('hidden');
          document.getElementById('move-btn').classList.remove('hidden');
          document.getElementById('side-column').classList.add('floating');
          alignSideColumn();
          document.getElementById('side-column').style.visibility = 'hidden';
          document.getElementById('hamburger-btn').classList.remove('hidden');
      isSideColumnVisibleByUser = false;
      });

      document.getElementById('move-btn').addEventListener('click', function() {
          this.classList.add('hidden');
          document.getElementById('hide-btn').classList.remove('hidden');
          document.getElementById('side-column').classList.remove('floating');
          document.getElementById('side-column').style.visibility = 'visible';
          document.getElementById('hamburger-btn').classList.add('hidden');
      isSideColumnVisibleByUser = true;
      });

      document.getElementById('hamburger-btn').addEventListener('click', function() {
          var sideColumn = document.getElementById('side-column');
          if (sideColumn.style.visibility === 'hidden') {
              sideColumn.style.visibility = 'visible';
        isSideColumnVisibleByUser = true;
          } else {
              sideColumn.style.visibility = 'hidden';
              sideColumn.classList.add('floating');
              document.getElementById('move-btn').classList.remove('hidden');
              document.getElementById('hide-btn').classList.add('hidden');
        isSideColumnVisibleByUser = false;
          }
      });

    function handleResize() {
      if (window.innerWidth < 768) {
        document.getElementById('side-column').classList.add('floating');
        document.getElementById('side-column').style.visibility = 'hidden';
        document.getElementById('hamburger-btn').classList.remove('hidden');
      } else {
        if (isSideColumnVisibleByUser) {
          document.getElementById('side-column').classList.remove('floating');
          document.getElementById('side-column').style.visibility = 'visible';
          document.getElementById('hamburger-btn').classList.add('hidden');
        }
      }
    }

    window.addEventListener('resize', handleResize);

    window.addEventListener('resize', function() {
          if (document.getElementById('side-column').classList.contains('floating')) {
              alignSideColumn();
          }
      });

      window.addEventListener('scroll', function() {
          if (document.getElementById('side-column').classList.contains('floating')) {
              alignSideColumn();
          }
      });

    window.onload = function() {
      handleResize();
    };
  </script>
<!-- END TODO FOR DOLCE: move to separate JS file -->
</body>
</html>
